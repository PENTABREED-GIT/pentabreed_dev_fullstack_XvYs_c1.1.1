<html>
<head>
	<title>UploadProc</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />	
	<meta name="author" content="JIRANSOFT Co., Ltd." />
	<link rel="stylesheet" href="../images/linkstyle.css" />
</head>
<body>
<table class="main top">
    <tr>
        <td class="on">
            <p class="pme2">Param</p>
        </td>
        <td class="off">
            <p class="pme">Method</p>
        </td>
        <td class="off">
            <p class="pme">Event</p>
        </td>
        <td width="10%">
            <p class="pme">&nbsp;</p>
        </td>
        <td width="50%">
            <p class="pme">&nbsp;</p>
        </td>
    </tr>
</table>
<table class="main">
    <tr>
        <td>
            <h1>UploadProc<sub>v4.3.2.32 or higher</sub></h1>
            <p class="dscrpt">이미지 업로드 시 고객사의 파일 업로드 모듈을 호출하여 실행합니다.</p>
			<p class="dscrpt">에디터에서 이미지 업로드 시 에디터 내부 업로드가 동작하지 않고 설정한 함수가 호출됩니다.</p>
			<p class="dscrpt">호출 시 파라미터로 넘어오는 object 값을 사용하여 업로드를 진행합니다.</p>
			<p class="dscrpt">모던 웹 브라우저에서 지원이 가능하며 Internet Explorer 9 이하에서는 지원하지 않습니다.</p>
			<p class="dscrpt">&nbsp;</p>
			<p class="dscrpt">- 적용 대상 : 그림 넣기, Copy&amp;Paste, Drag&amp;Drop, 배경 그림, 표 배경 그림, 셀 배경 그림</p>
            <p class="dscrpt">&nbsp;</p>
			
            <h4>Parameters</h4>
            <table class="paradsc2">
                <tr>
                    <td class="eee">
						 <p align="center">객체명</p>
                    </td>
                    <td class="eee">
                        <p align="center">용도</p>
                    </td>
                </tr>
                <tr>
                    <td>            
                        <p align="center">formData</p>
                    </td>
                    <td>
                        <p align="left">업로드에 필요한 정보 및 파일을 담고 있는 폼 데이터</p>
                    </td>
                </tr>
				<tr>
                    <td>            
                        <p align="center">dataObj</p>
                    </td>
                    <td>
                        <p align="left">업로드에 필요한 정보 및 파일 데이터</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p align="center">complete</p>
                    </td>
                    <td>
                        <p align="left">업로드 완료 후 호출되는 함수<br/>서버에서 넘어온 Text 값을 넘겨줌</p>
                    </td>
                </tr>
				<tr>
                    <td>       
                        <p align="center">error</p>
                    </td>
                    <td>
                        <p align="left">업로드 실패 후에 호출되는 함수<br />업로드 실패 메시지 text를 넘겨주면 메시지를 출력</p>
                    </td>
                </tr>
            </table>			
            <p class="dscrpt">&nbsp;</p>
			
			<h4>Sample Codes</h4>
            <pre class="scodedsc">var CrossEditor = new NamoSE(&quot;test&quot;);
CrossEditor.params.<strong>event.UploadProc</strong> = function(obj){
	var newFormData = new FormData();   //Object정보를 담을 새로운 formData
	
	if(obj.dataObj.plugins && obj.files){	//오피스플러그인 모드일 경우
		for(var i = 0; i&lt;obj.files.length; i++){
			newFormData.append(obj.files[i].inputFileName, obj.files[i].blob, obj.files[i].filename);
		}
	}
	
	Object.keys(obj.dataObj).forEach(function(key){
		newFormData.append(key, obj.dataObj[key]); //Object정보를 formData에 설정
		console.log(key + ' | ' + obj.dataObj[key]);
	});
	
	var xhr = new XMLHttpRequest();
	
	if(obj.dataObj.plugins){	//오피스플러그인 모드 Copy&Paste
		xhr.open('POST', "이미지 업로드 url"); //이미지업로드 url
	} else{
		if(obj.dataObj.fileKind == "image" || obj.dataObj.imageKind == "image"){
			url = "이미지 업로드 url";
		}else if(obj.dataObj.fileKind == "file" || obj.dataObj.imageKind == "file"){
			url = "파일 업로드 url";
		}else if(obj.dataObj.fileKind == "flash" || obj.dataObj.imageKind =="flash"){
			url = "동영상 업로드 url";
		}else if(obj.dataObj.imageKind == "backgroundimage"){ // 배경그림 넣기 경우 처리 추가
			url = "배경그림 업로드 url";
		}
		xhr.open('POST', url);	//savePathURL
	}
	
	xhr.onload = function () {
		if (xhr.status === 200) {
			obj.complete(xhr.responseText); //업로드 성공 후에 호출
		}else{	//onerror가 발생하지 않는 경우 예외처리 (IE)
			if(!obj.dataObj.plugins){
				obj.error("upload fail!!");
			} else{
				obj.error("plugin mode_upload fail!")
			}
		}
	};
	
	xhr.onerror = function(){	 //업로드 실패 시에 호출
		if(!obj.dataObj.plugins){
			obj.error("upload fail!!");
		}else{
			obj.error("plugin mode_upload fail!")
		}        
	};
	
	xhr.send(newFormData); //formData 설정
}
CrossEditor.EditorStart();</pre>
            <p class="dscrpt">&nbsp;</p>
        </td>
    </tr>
</table>
</body>
</html>